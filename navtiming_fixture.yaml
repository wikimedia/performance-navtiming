# Test cases for TestNavTiming#test_handlers

# When using data from a production sample, be sure to anonimise the
# following properties:
# - event
#    # Schema:NavigationTiming
#    - namespaceId: 1
#    - revId: 1
#    - pageId: 1
# - recvFrom: example
# - seqId: 1
# - timestamp: 1
# - uuid: example
# - webHost: example

templates:
  - &expected_uncached_desktop
    - frontend.navtiming2.mediaWikiLoadEnd.desktop.authenticated:1269|ms
    - frontend.navtiming2.mediaWikiLoadEnd.desktop.overall:1269|ms
    - frontend.navtiming2.mediaWikiLoadEnd.overall:1269|ms
    - frontend.navtiming2.mediaWikiLoadEnd.by_browser.Firefox.55:1269|ms
    - frontend.navtiming2.mediaWikiLoadEnd.by_browser.Firefox.all:1269|ms
    - frontend.navtiming2.mediaWikiLoadEnd.by_continent.Europe:1269|ms
    - frontend.navtiming2.mediaWikiLoadEnd.by_country.other:1269|ms
    - frontend.navtiming2.onLoad.desktop.authenticated:3|ms
    - frontend.navtiming2.onLoad.desktop.overall:3|ms
    - frontend.navtiming2.onLoad.overall:3|ms
    - frontend.navtiming2.onLoad.by_browser.Firefox.55:3|ms
    - frontend.navtiming2.onLoad.by_browser.Firefox.all:3|ms
    - frontend.navtiming2.onLoad.by_continent.Europe:3|ms
    - frontend.navtiming2.onLoad.by_country.other:3|ms
    - frontend.navtiming2.dns.desktop.authenticated:1|ms
    - frontend.navtiming2.dns.desktop.overall:1|ms
    - frontend.navtiming2.dns.overall:1|ms
    - frontend.navtiming2.dns.by_browser.Firefox.55:1|ms
    - frontend.navtiming2.dns.by_browser.Firefox.all:1|ms
    - frontend.navtiming2.dns.by_continent.Europe:1|ms
    - frontend.navtiming2.dns.by_country.other:1|ms
    - frontend.navtiming2.unload.desktop.authenticated:4|ms
    - frontend.navtiming2.unload.desktop.overall:4|ms
    - frontend.navtiming2.unload.overall:4|ms
    - frontend.navtiming2.unload.by_browser.Firefox.55:4|ms
    - frontend.navtiming2.unload.by_browser.Firefox.all:4|ms
    - frontend.navtiming2.unload.by_continent.Europe:4|ms
    - frontend.navtiming2.unload.by_country.other:4|ms
    - frontend.navtiming2.processing.desktop.authenticated:1550|ms
    - frontend.navtiming2.processing.desktop.overall:1550|ms
    - frontend.navtiming2.processing.overall:1550|ms
    - frontend.navtiming2.processing.by_browser.Firefox.55:1550|ms
    - frontend.navtiming2.processing.by_browser.Firefox.all:1550|ms
    - frontend.navtiming2.processing.by_continent.Europe:1550|ms
    - frontend.navtiming2.processing.by_country.other:1550|ms
    - frontend.navtiming2.request.desktop.authenticated:374|ms
    - frontend.navtiming2.request.desktop.overall:374|ms
    - frontend.navtiming2.request.overall:374|ms
    - frontend.navtiming2.request.by_browser.Firefox.55:374|ms
    - frontend.navtiming2.request.by_browser.Firefox.all:374|ms
    - frontend.navtiming2.request.by_continent.Europe:374|ms
    - frontend.navtiming2.request.by_country.other:374|ms
    - frontend.navtiming2.tcp.desktop.authenticated:0|ms
    - frontend.navtiming2.tcp.desktop.overall:0|ms
    - frontend.navtiming2.tcp.overall:0|ms
    - frontend.navtiming2.tcp.by_browser.Firefox.55:0|ms
    - frontend.navtiming2.tcp.by_browser.Firefox.all:0|ms
    - frontend.navtiming2.tcp.by_continent.Europe:0|ms
    - frontend.navtiming2.tcp.by_country.other:0|ms
    - frontend.navtiming2.loadEventEnd.desktop.authenticated:1967|ms
    - frontend.navtiming2.loadEventEnd.desktop.overall:1967|ms
    - frontend.navtiming2.loadEventEnd.overall:1967|ms
    - frontend.navtiming2.loadEventEnd.by_browser.Firefox.55:1967|ms
    - frontend.navtiming2.loadEventEnd.by_browser.Firefox.all:1967|ms
    - frontend.navtiming2.loadEventEnd.by_continent.Europe:1967|ms
    - frontend.navtiming2.loadEventEnd.by_country.other:1967|ms
    - frontend.navtiming2.loadEventStart.desktop.authenticated:1964|ms
    - frontend.navtiming2.loadEventStart.desktop.overall:1964|ms
    - frontend.navtiming2.loadEventStart.overall:1964|ms
    - frontend.navtiming2.loadEventStart.by_browser.Firefox.55:1964|ms
    - frontend.navtiming2.loadEventStart.by_browser.Firefox.all:1964|ms
    - frontend.navtiming2.loadEventStart.by_continent.Europe:1964|ms
    - frontend.navtiming2.loadEventStart.by_country.other:1964|ms
    - frontend.navtiming2.response.desktop.authenticated:35|ms
    - frontend.navtiming2.response.desktop.overall:35|ms
    - frontend.navtiming2.response.overall:35|ms
    - frontend.navtiming2.response.by_browser.Firefox.55:35|ms
    - frontend.navtiming2.response.by_browser.Firefox.all:35|ms
    - frontend.navtiming2.response.by_continent.Europe:35|ms
    - frontend.navtiming2.response.by_country.other:35|ms
    - frontend.navtiming2.domComplete.desktop.authenticated:1964|ms
    - frontend.navtiming2.domComplete.desktop.overall:1964|ms
    - frontend.navtiming2.domComplete.overall:1964|ms
    - frontend.navtiming2.domComplete.by_browser.Firefox.55:1964|ms
    - frontend.navtiming2.domComplete.by_browser.Firefox.all:1964|ms
    - frontend.navtiming2.domComplete.by_continent.Europe:1964|ms
    - frontend.navtiming2.domComplete.by_country.other:1964|ms
    - frontend.navtiming2.responseStart.desktop.authenticated:379|ms
    - frontend.navtiming2.responseStart.desktop.overall:379|ms
    - frontend.navtiming2.responseStart.overall:379|ms
    - frontend.navtiming2.responseStart.by_browser.Firefox.55:379|ms
    - frontend.navtiming2.responseStart.by_browser.Firefox.all:379|ms
    - frontend.navtiming2.responseStart.by_continent.Europe:379|ms
    - frontend.navtiming2.responseStart.by_country.other:379|ms
    - frontend.navtiming2.domInteractive.desktop.authenticated:955|ms
    - frontend.navtiming2.domInteractive.desktop.overall:955|ms
    - frontend.navtiming2.domInteractive.overall:955|ms
    - frontend.navtiming2.domInteractive.by_browser.Firefox.55:955|ms
    - frontend.navtiming2.domInteractive.by_browser.Firefox.all:955|ms
    - frontend.navtiming2.domInteractive.by_continent.Europe:955|ms
    - frontend.navtiming2.domInteractive.by_country.other:955|ms

# Sample from April 2018
# https://meta.wikimedia.org/w/index.php?title=Schema:NavigationTiming&oldid=17957960
Uncached page view from desktop with isOversample=false:
 input: {"event": {"action": "history", "connectEnd": 6, "connectStart": 6, "dnsLookup": 1, "domComplete": 1965, "domInteractive": 956, "fetchStart": 1, "isAnon": false, "isHiDPI": false, "isHttp2": true, "isOversample": false, "loadEventEnd": 1968, "loadEventStart": 1965, "mediaWikiLoadEnd": 1270, "mediaWikiVersion": "1.30.0-wmf.19", "namespaceId": 1, "originCountry": "RS", "originRegion": "VO", "pageId": 1, "requestStart": 6, "responseEnd": 415, "responseStart": 380, "revId": 1, "unload": 4, "cacheResponseType": "hit-front", "cacheHost": "foo", "transferSize": 34500}, "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
 expect:
  - *expected_uncached_desktop
  - frontend.navtiming_group.other:1|c
 metrics:
   - ['navtiming_responsestart_by_cache_host_seconds_count', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB'}, 1]
   - ['navtiming_responsestart_by_cache_host_seconds_sum', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB'}, 0.379]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB', 'le': '0.005'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB', 'le': '0.01'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB', 'le': '0.025'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB', 'le': '0.05'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB', 'le': '0.075'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB', 'le': '0.1'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB', 'le': '0.25'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'foo', 'cache_response_type': 'hit-front', 'transfer_size': '30kB - 60kB', 'le': '0.5'}, 1]

Uncached page view from desktop with isOversample=false and empty Server Timing data:
 input: {"event": {"action": "history", "connectEnd": 6, "connectStart": 6, "dnsLookup": 1, "domComplete": 1965, "domInteractive": 956, "fetchStart": 1, "isAnon": false, "isHiDPI": false, "isHttp2": true, "isOversample": false, "loadEventEnd": 1968, "loadEventStart": 1965, "mediaWikiLoadEnd": 1270, "mediaWikiVersion": "1.30.0-wmf.19", "namespaceId": 1, "originCountry": "RS", "originRegion": "VO", "pageId": 1, "requestStart": 6, "responseEnd": 415, "responseStart": 380, "revId": 1, "unload": 4, "cacheResponseType": "", "cacheHost": ""}, "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
 expect:
  - *expected_uncached_desktop
  - frontend.navtiming_group.other:1|c
 metrics:
   - ['navtiming_responsestart_by_cache_host_seconds_count', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown'}, 1]
   - ['navtiming_responsestart_by_cache_host_seconds_sum', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown'}, 0.379]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.005'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.01'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.025'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.05'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.075'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.1'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.25'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.5'}, 1]

Uncached page view from desktop with isOversample=false and missing Server Timing data 2:
 input: {"event": {"action": "history", "connectEnd": 6, "connectStart": 6, "dnsLookup": 1, "domComplete": 1965, "domInteractive": 956, "fetchStart": 1, "isAnon": false, "isHiDPI": false, "isHttp2": true, "isOversample": false, "loadEventEnd": 1968, "loadEventStart": 1965, "mediaWikiLoadEnd": 1270, "mediaWikiVersion": "1.30.0-wmf.19", "namespaceId": 1, "originCountry": "RS", "originRegion": "VO", "pageId": 1, "requestStart": 6, "responseEnd": 415, "responseStart": 380, "revId": 1, "unload": 4}, "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
 expect:
  - *expected_uncached_desktop
  - frontend.navtiming_group.other:1|c
 metrics:
   - ['navtiming_responsestart_by_cache_host_seconds_count', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown'}, 1]
   - ['navtiming_responsestart_by_cache_host_seconds_sum', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown'}, 0.379]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.005'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.01'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.025'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.05'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.075'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.1'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.25'}, 0]
   - ['navtiming_responsestart_by_cache_host_seconds_bucket', {'cache_host': 'unknown', 'cache_response_type': 'unknown', 'transfer_size': 'unknown', 'le': '0.5'}, 1]

# Sample from April 2018
# https://meta.wikimedia.org/w/index.php?title=Schema:NavigationTiming&oldid=17957960
Cached page view from desktop:
 input: {"event": {"action": "view", "connectEnd": 0, "connectStart": 0, "dnsLookup": 0, "domComplete": 1201, "domInteractive": 576, "fetchStart": 0, "firstPaint": 635, "isAnon": true, "isHiDPI": false, "isHttp2": true, "loadEventEnd": 1203, "loadEventStart": 1201, "mediaWikiLoadEnd": 667, "mediaWikiVersion": "1.30.0-wmf.19", "namespaceId": 1, "originCountry": "MA", "originRegion": "01", "pageId": 1, "requestStart": 16, "responseEnd": 373, "responseStart": 360, "revId": 1, "unload": 0}, "recvFrom": "example", "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 7\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"60\", \"browser_family\": \"Chrome\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
 expect:
  - frontend.navtiming2.onLoad.desktop.anonymous:2|ms
  - frontend.navtiming2.onLoad.desktop.overall:2|ms
  - frontend.navtiming2.onLoad.overall:2|ms
  - frontend.navtiming2.onLoad.by_browser.Chrome.60:2|ms
  - frontend.navtiming2.onLoad.by_browser.Chrome.all:2|ms
  - frontend.navtiming2.onLoad.by_continent.Africa:2|ms
  - frontend.navtiming2.onLoad.by_country.other:2|ms
  - frontend.navtiming2.dns.desktop.anonymous:0|ms
  - frontend.navtiming2.dns.desktop.overall:0|ms
  - frontend.navtiming2.dns.overall:0|ms
  - frontend.navtiming2.dns.by_browser.Chrome.60:0|ms
  - frontend.navtiming2.dns.by_browser.Chrome.all:0|ms
  - frontend.navtiming2.dns.by_continent.Africa:0|ms
  - frontend.navtiming2.dns.by_country.other:0|ms
  - frontend.navtiming2.unload.desktop.anonymous:0|ms
  - frontend.navtiming2.unload.desktop.overall:0|ms
  - frontend.navtiming2.unload.overall:0|ms
  - frontend.navtiming2.unload.by_browser.Chrome.60:0|ms
  - frontend.navtiming2.unload.by_browser.Chrome.all:0|ms
  - frontend.navtiming2.unload.by_continent.Africa:0|ms
  - frontend.navtiming2.unload.by_country.other:0|ms
  - frontend.navtiming2.request.desktop.anonymous:344|ms
  - frontend.navtiming2.request.desktop.overall:344|ms
  - frontend.navtiming2.request.overall:344|ms
  - frontend.navtiming2.request.by_browser.Chrome.60:344|ms
  - frontend.navtiming2.request.by_browser.Chrome.all:344|ms
  - frontend.navtiming2.request.by_continent.Africa:344|ms
  - frontend.navtiming2.request.by_country.other:344|ms
  - frontend.navtiming2.processing.desktop.anonymous:828|ms
  - frontend.navtiming2.processing.desktop.overall:828|ms
  - frontend.navtiming2.processing.overall:828|ms
  - frontend.navtiming2.processing.by_browser.Chrome.60:828|ms
  - frontend.navtiming2.processing.by_browser.Chrome.all:828|ms
  - frontend.navtiming2.processing.by_continent.Africa:828|ms
  - frontend.navtiming2.processing.by_country.other:828|ms
  - frontend.navtiming2.firstPaint.desktop.anonymous:635|ms
  - frontend.navtiming2.firstPaint.desktop.overall:635|ms
  - frontend.navtiming2.firstPaint.overall:635|ms
  - frontend.navtiming2.firstPaint.by_browser.Chrome.60:635|ms
  - frontend.navtiming2.firstPaint.by_browser.Chrome.all:635|ms
  - frontend.navtiming2.firstPaint.by_continent.Africa:635|ms
  - frontend.navtiming2.firstPaint.by_country.other:635|ms
  - frontend.navtiming2.tcp.desktop.anonymous:0|ms
  - frontend.navtiming2.tcp.desktop.overall:0|ms
  - frontend.navtiming2.tcp.overall:0|ms
  - frontend.navtiming2.tcp.by_browser.Chrome.60:0|ms
  - frontend.navtiming2.tcp.by_browser.Chrome.all:0|ms
  - frontend.navtiming2.tcp.by_continent.Africa:0|ms
  - frontend.navtiming2.tcp.by_country.other:0|ms
  - frontend.navtiming2.loadEventEnd.desktop.anonymous:1203|ms
  - frontend.navtiming2.loadEventEnd.desktop.overall:1203|ms
  - frontend.navtiming2.loadEventEnd.overall:1203|ms
  - frontend.navtiming2.loadEventEnd.by_browser.Chrome.60:1203|ms
  - frontend.navtiming2.loadEventEnd.by_browser.Chrome.all:1203|ms
  - frontend.navtiming2.loadEventEnd.by_continent.Africa:1203|ms
  - frontend.navtiming2.loadEventEnd.by_country.other:1203|ms
  - frontend.navtiming2.loadEventStart.desktop.anonymous:1201|ms
  - frontend.navtiming2.loadEventStart.desktop.overall:1201|ms
  - frontend.navtiming2.loadEventStart.overall:1201|ms
  - frontend.navtiming2.loadEventStart.by_browser.Chrome.60:1201|ms
  - frontend.navtiming2.loadEventStart.by_browser.Chrome.all:1201|ms
  - frontend.navtiming2.loadEventStart.by_continent.Africa:1201|ms
  - frontend.navtiming2.loadEventStart.by_country.other:1201|ms
  - frontend.navtiming2.response.desktop.anonymous:13|ms
  - frontend.navtiming2.response.desktop.overall:13|ms
  - frontend.navtiming2.response.overall:13|ms
  - frontend.navtiming2.response.by_browser.Chrome.60:13|ms
  - frontend.navtiming2.response.by_browser.Chrome.all:13|ms
  - frontend.navtiming2.response.by_continent.Africa:13|ms
  - frontend.navtiming2.response.by_country.other:13|ms
  - frontend.navtiming2.domComplete.desktop.anonymous:1201|ms
  - frontend.navtiming2.domComplete.desktop.overall:1201|ms
  - frontend.navtiming2.domComplete.overall:1201|ms
  - frontend.navtiming2.domComplete.by_browser.Chrome.60:1201|ms
  - frontend.navtiming2.domComplete.by_browser.Chrome.all:1201|ms
  - frontend.navtiming2.domComplete.by_continent.Africa:1201|ms
  - frontend.navtiming2.domComplete.by_country.other:1201|ms
  - frontend.navtiming2.responseStart.desktop.anonymous:360|ms
  - frontend.navtiming2.responseStart.desktop.overall:360|ms
  - frontend.navtiming2.responseStart.overall:360|ms
  - frontend.navtiming2.responseStart.by_browser.Chrome.60:360|ms
  - frontend.navtiming2.responseStart.by_browser.Chrome.all:360|ms
  - frontend.navtiming2.responseStart.by_continent.Africa:360|ms
  - frontend.navtiming2.responseStart.by_country.other:360|ms
  - frontend.navtiming2.domInteractive.desktop.anonymous:576|ms
  - frontend.navtiming2.domInteractive.desktop.overall:576|ms
  - frontend.navtiming2.domInteractive.overall:576|ms
  - frontend.navtiming2.domInteractive.by_browser.Chrome.60:576|ms
  - frontend.navtiming2.domInteractive.by_browser.Chrome.all:576|ms
  - frontend.navtiming2.domInteractive.by_continent.Africa:576|ms
  - frontend.navtiming2.domInteractive.by_country.other:576|ms
  - frontend.navtiming2.mediaWikiLoadEnd.desktop.anonymous:667|ms
  - frontend.navtiming2.mediaWikiLoadEnd.desktop.overall:667|ms
  - frontend.navtiming2.mediaWikiLoadEnd.overall:667|ms
  - frontend.navtiming2.mediaWikiLoadEnd.by_browser.Chrome.60:667|ms
  - frontend.navtiming2.mediaWikiLoadEnd.by_browser.Chrome.all:667|ms
  - frontend.navtiming2.mediaWikiLoadEnd.by_continent.Africa:667|ms
  - frontend.navtiming2.mediaWikiLoadEnd.by_country.other:667|ms
  - frontend.navtiming_group.other:1|c

# Sample from September 2017
# https://meta.wikimedia.org/w/index.php?title=Schema:NavigationTiming&oldid=17216284
Mobile page view:
 input: {"event": {"action": "edit", "connectEnd": 0, "connectStart": 0, "dnsLookup": 0, "domComplete": 3515, "domInteractive": 2936, "fetchStart": 0, "isAnon": true, "isHiDPI": false, "isHttp2": true, "loadEventEnd": 3520, "loadEventStart": 3515, "mediaWikiLoadComplete": 907, "mediaWikiVersion": "1.30.0-wmf.19", "mobileMode": "stable", "namespaceId": 1, "originCountry": "RU", "originRegion": "PER", "pageId": 1, "requestStart": 1, "responseEnd": 2631, "responseStart": 2367, "revId": 1}, "recvFrom": "example", "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": \"3\", \"is_bot\": false, \"os_major\": \"9\", \"device_family\": \"iPad\", \"os_family\": \"iOS\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"9\", \"browser_family\": \"Mobile Safari\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
 expect:
  - frontend.navtiming2.onLoad.mobile.anonymous:5|ms
  - frontend.navtiming2.onLoad.mobile.overall:5|ms
  - frontend.navtiming2.onLoad.overall:5|ms
  - frontend.navtiming2.onLoad.by_browser.Mobile_Safari.9_0:5|ms
  - frontend.navtiming2.onLoad.by_browser.Mobile_Safari.all:5|ms
  - frontend.navtiming2.onLoad.by_continent.Europe:5|ms
  - frontend.navtiming2.onLoad.by_country.Russia:5|ms
  - frontend.navtiming2.dns.mobile.anonymous:0|ms
  - frontend.navtiming2.dns.mobile.overall:0|ms
  - frontend.navtiming2.dns.overall:0|ms
  - frontend.navtiming2.dns.by_browser.Mobile_Safari.9_0:0|ms
  - frontend.navtiming2.dns.by_browser.Mobile_Safari.all:0|ms
  - frontend.navtiming2.dns.by_continent.Europe:0|ms
  - frontend.navtiming2.dns.by_country.Russia:0|ms
  - frontend.navtiming2.processing.mobile.anonymous:884|ms
  - frontend.navtiming2.processing.mobile.overall:884|ms
  - frontend.navtiming2.processing.overall:884|ms
  - frontend.navtiming2.processing.by_browser.Mobile_Safari.9_0:884|ms
  - frontend.navtiming2.processing.by_browser.Mobile_Safari.all:884|ms
  - frontend.navtiming2.processing.by_continent.Europe:884|ms
  - frontend.navtiming2.processing.by_country.Russia:884|ms
  - frontend.navtiming2.request.mobile.anonymous:2366|ms
  - frontend.navtiming2.request.mobile.overall:2366|ms
  - frontend.navtiming2.request.overall:2366|ms
  - frontend.navtiming2.request.by_browser.Mobile_Safari.9_0:2366|ms
  - frontend.navtiming2.request.by_browser.Mobile_Safari.all:2366|ms
  - frontend.navtiming2.request.by_continent.Europe:2366|ms
  - frontend.navtiming2.request.by_country.Russia:2366|ms
  - frontend.navtiming2.tcp.mobile.anonymous:0|ms
  - frontend.navtiming2.tcp.mobile.overall:0|ms
  - frontend.navtiming2.tcp.overall:0|ms
  - frontend.navtiming2.tcp.by_browser.Mobile_Safari.9_0:0|ms
  - frontend.navtiming2.tcp.by_browser.Mobile_Safari.all:0|ms
  - frontend.navtiming2.tcp.by_continent.Europe:0|ms
  - frontend.navtiming2.tcp.by_country.Russia:0|ms
  - frontend.navtiming2.loadEventEnd.mobile.anonymous:3520|ms
  - frontend.navtiming2.loadEventEnd.mobile.overall:3520|ms
  - frontend.navtiming2.loadEventEnd.overall:3520|ms
  - frontend.navtiming2.loadEventEnd.by_browser.Mobile_Safari.9_0:3520|ms
  - frontend.navtiming2.loadEventEnd.by_browser.Mobile_Safari.all:3520|ms
  - frontend.navtiming2.loadEventEnd.by_continent.Europe:3520|ms
  - frontend.navtiming2.loadEventEnd.by_country.Russia:3520|ms
  - frontend.navtiming2.loadEventStart.mobile.anonymous:3515|ms
  - frontend.navtiming2.loadEventStart.mobile.overall:3515|ms
  - frontend.navtiming2.loadEventStart.overall:3515|ms
  - frontend.navtiming2.loadEventStart.by_browser.Mobile_Safari.9_0:3515|ms
  - frontend.navtiming2.loadEventStart.by_browser.Mobile_Safari.all:3515|ms
  - frontend.navtiming2.loadEventStart.by_continent.Europe:3515|ms
  - frontend.navtiming2.loadEventStart.by_country.Russia:3515|ms
  - frontend.navtiming2.response.mobile.anonymous:264|ms
  - frontend.navtiming2.response.mobile.overall:264|ms
  - frontend.navtiming2.response.overall:264|ms
  - frontend.navtiming2.response.by_browser.Mobile_Safari.9_0:264|ms
  - frontend.navtiming2.response.by_browser.Mobile_Safari.all:264|ms
  - frontend.navtiming2.response.by_continent.Europe:264|ms
  - frontend.navtiming2.response.by_country.Russia:264|ms
  - frontend.navtiming2.domComplete.mobile.anonymous:3515|ms
  - frontend.navtiming2.domComplete.mobile.overall:3515|ms
  - frontend.navtiming2.domComplete.overall:3515|ms
  - frontend.navtiming2.domComplete.by_browser.Mobile_Safari.9_0:3515|ms
  - frontend.navtiming2.domComplete.by_browser.Mobile_Safari.all:3515|ms
  - frontend.navtiming2.domComplete.by_continent.Europe:3515|ms
  - frontend.navtiming2.domComplete.by_country.Russia:3515|ms
  - frontend.navtiming2.responseStart.mobile.anonymous:2367|ms
  - frontend.navtiming2.responseStart.mobile.overall:2367|ms
  - frontend.navtiming2.responseStart.overall:2367|ms
  - frontend.navtiming2.responseStart.by_browser.Mobile_Safari.9_0:2367|ms
  - frontend.navtiming2.responseStart.by_browser.Mobile_Safari.all:2367|ms
  - frontend.navtiming2.responseStart.by_continent.Europe:2367|ms
  - frontend.navtiming2.responseStart.by_country.Russia:2367|ms
  - frontend.navtiming2.domInteractive.mobile.anonymous:2936|ms
  - frontend.navtiming2.domInteractive.mobile.overall:2936|ms
  - frontend.navtiming2.domInteractive.overall:2936|ms
  - frontend.navtiming2.domInteractive.by_browser.Mobile_Safari.9_0:2936|ms
  - frontend.navtiming2.domInteractive.by_browser.Mobile_Safari.all:2936|ms
  - frontend.navtiming2.domInteractive.by_continent.Europe:2936|ms
  - frontend.navtiming2.domInteractive.by_country.Russia:2936|ms
  - frontend.navtiming_group.other:1|c

# Sample from September 2017 (added gaps)
# https://meta.wikimedia.org/w/index.php?title=Schema:NavigationTiming&oldid=17216284
View with timings above threshold (for navtiming):
 input: {"event": {"action": "view", "connectEnd": 0, "connectStart": 0, "dnsLookup": 0, "domComplete": 203077, "domInteractive": 7403, "fetchStart": 0, "firstPaint": 9356, "isAnon": true, "isHiDPI": false, "isHttp2": true, "loadEventEnd": 204085, "loadEventStart": 204083, "mediaWikiLoadComplete": 20922, "mediaWikiVersion": "1.30.0-wmf.19", "namespaceId": 1, "originCountry": "FR", "originRegion": "X", "pageId": 1, "requestStart": 4484, "responseEnd": 6286, "responseStart": 5027, "revId": 1, "gaps": 12}, "recvFrom": "example", "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 10\", \"browser_minor\": \"15063\", \"wmf_app_version\": \"-\", \"browser_major\": \"15\", \"browser_family\": \"Edge\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
 expect:
  # domComplete, loadEventStart and loadEventEnd are above threshold (FIXME)
  - frontend.navtiming2.onLoad.desktop.anonymous:2|ms
  - frontend.navtiming2.onLoad.desktop.overall:2|ms
  - frontend.navtiming2.onLoad.overall:2|ms
  - frontend.navtiming2.onLoad.by_browser.Edge.15:2|ms
  - frontend.navtiming2.onLoad.by_browser.Edge.all:2|ms
  - frontend.navtiming2.onLoad.by_continent.Europe:2|ms
  - frontend.navtiming2.onLoad.by_country.France:2|ms
  - frontend.navtiming2.dns.desktop.anonymous:0|ms
  - frontend.navtiming2.dns.desktop.overall:0|ms
  - frontend.navtiming2.dns.overall:0|ms
  - frontend.navtiming2.dns.by_browser.Edge.15:0|ms
  - frontend.navtiming2.dns.by_browser.Edge.all:0|ms
  - frontend.navtiming2.dns.by_continent.Europe:0|ms
  - frontend.navtiming2.dns.by_country.France:0|ms
  - frontend.navtiming2.request.desktop.anonymous:543|ms
  - frontend.navtiming2.request.desktop.overall:543|ms
  - frontend.navtiming2.request.overall:543|ms
  - frontend.navtiming2.request.by_browser.Edge.15:543|ms
  - frontend.navtiming2.request.by_browser.Edge.all:543|ms
  - frontend.navtiming2.request.by_continent.Europe:543|ms
  - frontend.navtiming2.request.by_country.France:543|ms
  - frontend.navtiming2.processing.desktop.anonymous:196791|ms
  - frontend.navtiming2.processing.desktop.overall:196791|ms
  - frontend.navtiming2.processing.overall:196791|ms
  - frontend.navtiming2.processing.by_browser.Edge.15:196791|ms
  - frontend.navtiming2.processing.by_browser.Edge.all:196791|ms
  - frontend.navtiming2.processing.by_continent.Europe:196791|ms
  - frontend.navtiming2.processing.by_country.France:196791|ms
  - frontend.navtiming2.firstPaint.desktop.anonymous:9356|ms
  - frontend.navtiming2.firstPaint.desktop.overall:9356|ms
  - frontend.navtiming2.firstPaint.overall:9356|ms
  - frontend.navtiming2.firstPaint.by_browser.Edge.15:9356|ms
  - frontend.navtiming2.firstPaint.by_browser.Edge.all:9356|ms
  - frontend.navtiming2.firstPaint.by_continent.Europe:9356|ms
  - frontend.navtiming2.firstPaint.by_country.France:9356|ms
  - frontend.navtiming2.tcp.desktop.anonymous:0|ms
  - frontend.navtiming2.tcp.desktop.overall:0|ms
  - frontend.navtiming2.tcp.overall:0|ms
  - frontend.navtiming2.tcp.by_browser.Edge.15:0|ms
  - frontend.navtiming2.tcp.by_browser.Edge.all:0|ms
  - frontend.navtiming2.tcp.by_continent.Europe:0|ms
  - frontend.navtiming2.tcp.by_country.France:0|ms
  - frontend.navtiming2.loadEventEnd.desktop.anonymous:204085|ms
  - frontend.navtiming2.loadEventEnd.desktop.overall:204085|ms
  - frontend.navtiming2.loadEventEnd.overall:204085|ms
  - frontend.navtiming2.loadEventEnd.by_browser.Edge.15:204085|ms
  - frontend.navtiming2.loadEventEnd.by_browser.Edge.all:204085|ms
  - frontend.navtiming2.loadEventEnd.by_continent.Europe:204085|ms
  - frontend.navtiming2.loadEventEnd.by_country.France:204085|ms
  - frontend.navtiming2.loadEventStart.desktop.anonymous:204083|ms
  - frontend.navtiming2.loadEventStart.desktop.overall:204083|ms
  - frontend.navtiming2.loadEventStart.overall:204083|ms
  - frontend.navtiming2.loadEventStart.by_browser.Edge.15:204083|ms
  - frontend.navtiming2.loadEventStart.by_browser.Edge.all:204083|ms
  - frontend.navtiming2.loadEventStart.by_continent.Europe:204083|ms
  - frontend.navtiming2.loadEventStart.by_country.France:204083|ms
  - frontend.navtiming2.response.desktop.anonymous:1259|ms
  - frontend.navtiming2.response.desktop.overall:1259|ms
  - frontend.navtiming2.response.overall:1259|ms
  - frontend.navtiming2.response.by_browser.Edge.15:1259|ms
  - frontend.navtiming2.response.by_browser.Edge.all:1259|ms
  - frontend.navtiming2.response.by_continent.Europe:1259|ms
  - frontend.navtiming2.response.by_country.France:1259|ms
  - frontend.navtiming2.domComplete.desktop.anonymous:203077|ms
  - frontend.navtiming2.domComplete.desktop.overall:203077|ms
  - frontend.navtiming2.domComplete.overall:203077|ms
  - frontend.navtiming2.domComplete.by_browser.Edge.15:203077|ms
  - frontend.navtiming2.domComplete.by_browser.Edge.all:203077|ms
  - frontend.navtiming2.domComplete.by_continent.Europe:203077|ms
  - frontend.navtiming2.domComplete.by_country.France:203077|ms
  - frontend.navtiming2.responseStart.desktop.anonymous:5027|ms
  - frontend.navtiming2.responseStart.desktop.overall:5027|ms
  - frontend.navtiming2.responseStart.overall:5027|ms
  - frontend.navtiming2.responseStart.by_browser.Edge.15:5027|ms
  - frontend.navtiming2.responseStart.by_browser.Edge.all:5027|ms
  - frontend.navtiming2.responseStart.by_continent.Europe:5027|ms
  - frontend.navtiming2.responseStart.by_country.France:5027|ms
  - frontend.navtiming2.domInteractive.desktop.anonymous:7403|ms
  - frontend.navtiming2.domInteractive.desktop.overall:7403|ms
  - frontend.navtiming2.domInteractive.overall:7403|ms
  - frontend.navtiming2.domInteractive.by_browser.Edge.15:7403|ms
  - frontend.navtiming2.domInteractive.by_browser.Edge.all:7403|ms
  - frontend.navtiming2.domInteractive.by_continent.Europe:7403|ms
  - frontend.navtiming2.domInteractive.by_country.France:7403|ms
  - frontend.navtiming2.gaps.desktop.anonymous:12|ms
  - frontend.navtiming2.gaps.desktop.overall:12|ms
  - frontend.navtiming2.gaps.overall:12|ms
  - frontend.navtiming2.gaps.by_browser.Edge.15:12|ms
  - frontend.navtiming2.gaps.by_browser.Edge.all:12|ms
  - frontend.navtiming2.gaps.by_continent.Europe:12|ms
  - frontend.navtiming2.gaps.by_country.France:12|ms
  - frontend.navtiming_group.other:1|c

# Sample from February 2018 (added 'isOversample', 'oversampleReason')
# https://meta.wikimedia.org/w/index.php?title=Schema:NavigationTiming&oldid=17740037
#     oversampleReason provided is an empty list
Uncached page view from desktop that includes isOversample=true:
 input: {"event": {"action": "history", "connectEnd": 6, "connectStart": 6, "dnsLookup": 1, "domComplete": 1965, "domInteractive": 956, "fetchStart": 1, "isAnon": false, "isHiDPI": false, "isHttp2": true, "isOversample": true, "oversampleReason": '[]', "loadEventEnd": 1968, "loadEventStart": 1965, "mediaWikiLoadComplete": 1270, "mediaWikiVersion": "1.30.0-wmf.19", "namespaceId": 1, "originCountry": "RS", "originRegion": "VO", "pageId": 1, "requestStart": 6, "responseEnd": 415, "responseStart": 380, "revId": 1, "unload": 4}, "recvFrom": "example", "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
 expect:
  - frontend.navtiming2_oversample.onLoad.desktop.authenticated:3|ms
  - frontend.navtiming2_oversample.onLoad.desktop.overall:3|ms
  - frontend.navtiming2_oversample.onLoad.overall:3|ms
  - frontend.navtiming2_oversample.onLoad.by_browser.Firefox.55:3|ms
  - frontend.navtiming2_oversample.onLoad.by_browser.Firefox.all:3|ms
  - frontend.navtiming2_oversample.onLoad.by_continent.Europe:3|ms
  - frontend.navtiming2_oversample.onLoad.by_country.other:3|ms
  - frontend.navtiming2_oversample.dns.desktop.authenticated:1|ms
  - frontend.navtiming2_oversample.dns.desktop.overall:1|ms
  - frontend.navtiming2_oversample.dns.overall:1|ms
  - frontend.navtiming2_oversample.dns.by_browser.Firefox.55:1|ms
  - frontend.navtiming2_oversample.dns.by_browser.Firefox.all:1|ms
  - frontend.navtiming2_oversample.dns.by_continent.Europe:1|ms
  - frontend.navtiming2_oversample.dns.by_country.other:1|ms
  - frontend.navtiming2_oversample.unload.desktop.authenticated:4|ms
  - frontend.navtiming2_oversample.unload.desktop.overall:4|ms
  - frontend.navtiming2_oversample.unload.overall:4|ms
  - frontend.navtiming2_oversample.unload.by_browser.Firefox.55:4|ms
  - frontend.navtiming2_oversample.unload.by_browser.Firefox.all:4|ms
  - frontend.navtiming2_oversample.unload.by_continent.Europe:4|ms
  - frontend.navtiming2_oversample.unload.by_country.other:4|ms
  - frontend.navtiming2_oversample.processing.desktop.authenticated:1550|ms
  - frontend.navtiming2_oversample.processing.desktop.overall:1550|ms
  - frontend.navtiming2_oversample.processing.overall:1550|ms
  - frontend.navtiming2_oversample.processing.by_browser.Firefox.55:1550|ms
  - frontend.navtiming2_oversample.processing.by_browser.Firefox.all:1550|ms
  - frontend.navtiming2_oversample.processing.by_continent.Europe:1550|ms
  - frontend.navtiming2_oversample.processing.by_country.other:1550|ms
  - frontend.navtiming2_oversample.request.desktop.authenticated:374|ms
  - frontend.navtiming2_oversample.request.desktop.overall:374|ms
  - frontend.navtiming2_oversample.request.overall:374|ms
  - frontend.navtiming2_oversample.request.by_browser.Firefox.55:374|ms
  - frontend.navtiming2_oversample.request.by_browser.Firefox.all:374|ms
  - frontend.navtiming2_oversample.request.by_continent.Europe:374|ms
  - frontend.navtiming2_oversample.request.by_country.other:374|ms
  - frontend.navtiming2_oversample.tcp.desktop.authenticated:0|ms
  - frontend.navtiming2_oversample.tcp.desktop.overall:0|ms
  - frontend.navtiming2_oversample.tcp.overall:0|ms
  - frontend.navtiming2_oversample.tcp.by_browser.Firefox.55:0|ms
  - frontend.navtiming2_oversample.tcp.by_browser.Firefox.all:0|ms
  - frontend.navtiming2_oversample.tcp.by_continent.Europe:0|ms
  - frontend.navtiming2_oversample.tcp.by_country.other:0|ms
  - frontend.navtiming2_oversample.loadEventEnd.desktop.authenticated:1967|ms
  - frontend.navtiming2_oversample.loadEventEnd.desktop.overall:1967|ms
  - frontend.navtiming2_oversample.loadEventEnd.overall:1967|ms
  - frontend.navtiming2_oversample.loadEventEnd.by_browser.Firefox.55:1967|ms
  - frontend.navtiming2_oversample.loadEventEnd.by_browser.Firefox.all:1967|ms
  - frontend.navtiming2_oversample.loadEventEnd.by_continent.Europe:1967|ms
  - frontend.navtiming2_oversample.loadEventEnd.by_country.other:1967|ms
  - frontend.navtiming2_oversample.loadEventStart.desktop.authenticated:1964|ms
  - frontend.navtiming2_oversample.loadEventStart.desktop.overall:1964|ms
  - frontend.navtiming2_oversample.loadEventStart.overall:1964|ms
  - frontend.navtiming2_oversample.loadEventStart.by_browser.Firefox.55:1964|ms
  - frontend.navtiming2_oversample.loadEventStart.by_browser.Firefox.all:1964|ms
  - frontend.navtiming2_oversample.loadEventStart.by_continent.Europe:1964|ms
  - frontend.navtiming2_oversample.loadEventStart.by_country.other:1964|ms
  - frontend.navtiming2_oversample.response.desktop.authenticated:35|ms
  - frontend.navtiming2_oversample.response.desktop.overall:35|ms
  - frontend.navtiming2_oversample.response.overall:35|ms
  - frontend.navtiming2_oversample.response.by_browser.Firefox.55:35|ms
  - frontend.navtiming2_oversample.response.by_browser.Firefox.all:35|ms
  - frontend.navtiming2_oversample.response.by_continent.Europe:35|ms
  - frontend.navtiming2_oversample.response.by_country.other:35|ms
  - frontend.navtiming2_oversample.domComplete.desktop.authenticated:1964|ms
  - frontend.navtiming2_oversample.domComplete.desktop.overall:1964|ms
  - frontend.navtiming2_oversample.domComplete.overall:1964|ms
  - frontend.navtiming2_oversample.domComplete.by_browser.Firefox.55:1964|ms
  - frontend.navtiming2_oversample.domComplete.by_browser.Firefox.all:1964|ms
  - frontend.navtiming2_oversample.domComplete.by_continent.Europe:1964|ms
  - frontend.navtiming2_oversample.domComplete.by_country.other:1964|ms
  - frontend.navtiming2_oversample.responseStart.desktop.authenticated:379|ms
  - frontend.navtiming2_oversample.responseStart.desktop.overall:379|ms
  - frontend.navtiming2_oversample.responseStart.overall:379|ms
  - frontend.navtiming2_oversample.responseStart.by_browser.Firefox.55:379|ms
  - frontend.navtiming2_oversample.responseStart.by_browser.Firefox.all:379|ms
  - frontend.navtiming2_oversample.responseStart.by_continent.Europe:379|ms
  - frontend.navtiming2_oversample.responseStart.by_country.other:379|ms
  - frontend.navtiming2_oversample.domInteractive.desktop.authenticated:955|ms
  - frontend.navtiming2_oversample.domInteractive.desktop.overall:955|ms
  - frontend.navtiming2_oversample.domInteractive.overall:955|ms
  - frontend.navtiming2_oversample.domInteractive.by_browser.Firefox.55:955|ms
  - frontend.navtiming2_oversample.domInteractive.by_browser.Firefox.all:955|ms
  - frontend.navtiming2_oversample.domInteractive.by_continent.Europe:955|ms
  - frontend.navtiming2_oversample.domInteractive.by_country.other:955|ms
  - frontend.navtiming_group.other:1|c

# Sample from February 2018 (added 'isOversample', 'oversampleReason')
# https://meta.wikimedia.org/w/index.php?title=Schema:NavigationTiming&oldid=17740037
#    Oversample reason provided is '["geo:XX"]'
#    country code in the event does not match whitelist
Uncached page view from desktop that includes isOversample=true and oversampleReason with XX geo:
 input: {"event": {"action": "history", "domInteractive": 956, "isAnon": false, "isHiDPI": false, "isHttp2": true, "isOversample": true, "oversampleReason": '["geo:XX"]', "mediaWikiVersion": "1.30.0-wmf.19", "namespaceId": 1, "originCountry": "XX", "originRegion": "VO", "pageId": 1, "revId": 1}, "recvFrom": "example", "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
 expect:
  - frontend.navtiming2_oversample.domInteractive.desktop.authenticated:956|ms
  - frontend.navtiming2_oversample.domInteractive.desktop.overall:956|ms
  - frontend.navtiming2_oversample.domInteractive.overall:956|ms
  - frontend.navtiming2_oversample.domInteractive.by_browser.Firefox.55:956|ms
  - frontend.navtiming2_oversample.domInteractive.by_browser.Firefox.all:956|ms
  - frontend.navtiming2_oversample.domInteractive.by_country.XX:956|ms
  - frontend.navtiming2_oversample.domInteractive.by_continent.other:956|ms
  - frontend.navtiming_group.other:1|c

# Sample from April 2018
# https://meta.wikimedia.org/w/index.php?title=Schema:NavigationTiming&oldid=17957960
Page view without NavTiming support:
 input: {"event": {"isOversample": false, "mediaWikiLoadEnd": 1270, "namespaceId": 1, "originCountry": "RS", "originRegion": "VO"}, "recvFrom": "example", "revision": 1, "schema": "NavigationTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "ca.wikipedia.org", "wiki": "cawiki"}
 expect:
    - frontend.navtiming2.mediaWikiLoadEnd.desktop.authenticated:1270|ms
    - frontend.navtiming2.mediaWikiLoadEnd.desktop.overall:1270|ms
    - frontend.navtiming2.mediaWikiLoadEnd.overall:1270|ms
    - frontend.navtiming2.mediaWikiLoadEnd.by_browser.Firefox.55:1270|ms
    - frontend.navtiming2.mediaWikiLoadEnd.by_browser.Firefox.all:1270|ms
    - frontend.navtiming2.mediaWikiLoadEnd.by_continent.Europe:1270|ms
    - frontend.navtiming2.mediaWikiLoadEnd.by_country.other:1270|ms
    - frontend.navtiming_group.group1:1|c

# Sample from September 2017, and July 2018
# https://meta.wikimedia.org/w/index.php?title=Schema:SaveTiming&oldid=15396492
SaveTiming:
 input:
  - {"event": {"mediaWikiVersion": "1.30.0-wmf.14", "saveTiming": 2526}, "recvFrom": "example", "revision": 1, "schema": "SaveTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 7\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"54\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
  - {"event": {"mediaWikiVersion": "1.30.0-wmf.14", "saveTiming": 1042}, "recvFrom": "example", "revision": 1, "schema": "SaveTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"11\", \"browser_family\": \"IE\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
  - {"event": {"mediaWikiVersion": "1.30.0-wmf.14", "saveTiming": 2729}, "recvFrom": "example", "revision": 1, "schema": "SaveTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 10\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"60\", \"browser_family\": \"Chrome\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "example", "wiki": "example"}
  - {"event": {"mediaWikiVersion": "1.32.0-wmf.10", "saveTiming": 3353}, "recvFrom": "example", "revision": 15396492, "schema": "SaveTiming", "seqId": 1, "userAgent": {"browser_family": "Chrome", "browser_major": "67", "browser_minor": "0", "device_family": "Other", "is_bot": false, "is_mediawiki": false, "os_family": "Windows", "os_major": "7", "os_minor": null, "wmf_app_version": "-"}, "uuid": "example", "webHost": "example", "wiki": "enwiki"}
  - {"event": {"mediaWikiVersion": "1.32.0-wmf.10", "saveTiming": 651}, "recvFrom": "example", "revision": 15396492, "schema": "SaveTiming", "seqId": 1, "userAgent": {"browser_family": "Chrome", "browser_major": "67", "browser_minor": "0", "device_family": "Other", "is_bot": false, "is_mediawiki": false, "os_family": "Windows", "os_major": "7", "os_minor": null, "wmf_app_version": "-"}, "uuid": "example", "webHost": "example", "wiki": "commonswiki"}
  - {"event": {"mediaWikiVersion": "1.32.0-wmf.10", "saveTiming": 739}, "recvFrom": "example", "revision": 15396492, "schema": "SaveTiming", "seqId": 1, "userAgent": {"browser_family": "Chrome", "browser_major": "67", "browser_minor": "0", "device_family": "Other", "is_bot": false, "is_mediawiki": false, "os_family": "Windows", "os_major": "7", "os_minor": null, "wmf_app_version": "-"}, "uuid": "example", "webHost": "example", "wiki": "wikidatawiki"}
  - {"event": {"mediaWikiVersion": "1.32.0-wmf.10", "saveTiming": 949}, "recvFrom": "example", "revision": 15396492, "schema": "SaveTiming", "seqId": 1, "userAgent": {"browser_family": "Chrome", "browser_major": "67", "browser_minor": "0", "device_family": "Other", "is_bot": false, "is_mediawiki": false, "os_family": "Windows", "os_major": "7", "os_minor": null, "wmf_app_version": "-"}, "uuid": "example", "webHost": "example", "wiki": "mediawikiwiki"}
 expect:
  - mw.performance.save:1042|ms
  - mw.performance.save:2526|ms
  - mw.performance.save:2729|ms
  - mw.performance.save:3353|ms
  - mw.performance.save:651|ms
  - mw.performance.save:739|ms
  - mw.performance.save:949|ms
  - mw.performance.save_by_group.group1:651|ms
  - mw.performance.save_by_group.group1:739|ms
  - mw.performance.save_by_group.group2:3353|ms
  - mw.performance.save_by_group.other:1042|ms
  - mw.performance.save_by_group.other:2526|ms
  - mw.performance.save_by_group.other:2729|ms
  - mw.performance.save_by_group.other:949|ms

# Sample from April 2019
# https://meta.wikimedia.org/w/index.php?title=Schema:PaintTiming&oldid=19000009
PaintTiming:
 input:
  - {"event": {"pageviewToken":"example", "name":"first-paint", "startTime":805, "isOversample":true, "isAnon":false, "oversampleReason": "[\"wiki:cawiki\"]", "originCountry":"FR" }, "revision":19000009, "schema":"PaintTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "ca.wikipedia.org", "wiki": "cawiki"}
 expect:
  - frontend.navtiming2_oversample.firstPaint.desktop.authenticated:805|ms
  - frontend.navtiming2_oversample.firstPaint.desktop.overall:805|ms
  - frontend.navtiming2_oversample.firstPaint.overall:805|ms
  - frontend.navtiming2_oversample.firstPaint.by_browser.Firefox.55:805|ms
  - frontend.navtiming2_oversample.firstPaint.by_browser.Firefox.all:805|ms
  - frontend.navtiming2_oversample.firstPaint.by_continent.Europe:805|ms
  - frontend.navtiming2_oversample.firstPaint.by_country.France:805|ms
  - frontend.painttiming_group.group1:1|c
 metrics:
  - ['painttiming_seconds_count', {'metric': 'first-paint', 'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55'}, 1]
  - ['painttiming_seconds_sum', {'metric': 'first-paint', 'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55'}, 0.805]
  - ['painttiming_seconds_bucket', {'metric': 'first-paint', 'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55', 'le': '0.1'}, 0]
  - ['painttiming_seconds_bucket', {'metric': 'first-paint', 'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55', 'le': '0.5'}, 0]
  - ['painttiming_seconds_bucket', {'metric': 'first-paint', 'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55', 'le': '0.75'}, 0]
  - ['painttiming_seconds_bucket', {'metric': 'first-paint', 'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55', 'le': '1.0'}, 1]

QuickSurveyInitiation:
 input:
  - {"event": {"beaconCapable":"true", "surveySessionToken":"1234af", "pageviewToken":"foobar", "surveyCodeName":"perceived-performance-survey", "eventName":"eligible", "performanceNow":3 }, "revision":19000009, "schema":"QuickSurveyInitiation", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "ca.wikipedia.org", "wiki": "cawiki"}
  - {"event": {"beaconCapable":"true", "surveySessionToken":"1234af", "pageviewToken":"foobar", "surveyCodeName":"perceived-performance-survey", "eventName":"impression", "performanceNow":3 }, "revision":19000009, "schema":"QuickSurveyInitiation", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "ca.wikipedia.org", "wiki": "cawiki"}
 expect:
  - performance.survey_initiation.cawiki.eligible:1|c
  - performance.survey_initiation.cawiki.impression:1|c
 metrics:
   - ['performance_survey_initiations_total', {'wiki': 'cawiki', 'event': 'eligible'}, 1]
   - ['performance_survey_initiations_total', {'wiki': 'cawiki', 'event': 'impression'}, 1]

# Sample from April 2020
# https://meta.wikimedia.org/w/index.php?title=Schema:FirstInputTiming&oldid=19842486
FirstInputTiming:
 input:
  - {"event": {"pageviewToken":"foo","processingStart":28367,"processingEnd":28368,"name":"mousedown","startTime":28347,"duration":184,"FID":20}, "revision":19842486, "schema":"FirstInputTiming", "seqId": 1, "timestamp": 1, "userAgent": "{\"os_minor\": null, \"is_bot\": false, \"os_major\": null, \"device_family\": \"Other\", \"os_family\": \"Windows 8.1\", \"browser_minor\": \"0\", \"wmf_app_version\": \"-\", \"browser_major\": \"55\", \"browser_family\": \"Firefox\", \"is_mediawiki\": false}", "uuid": "example", "webHost": "ca.wikipedia.org", "wiki": "cawiki"}
 expect:
  - frontend.firstinputtiming.fid:20|ms
  - frontend.firstinputtiming.fid_by_group.group1:20|ms
 metrics:
   - ['firstinputdelay_seconds_count', {'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55'}, 1]
   - ['firstinputdelay_seconds_sum', {'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55'}, 0.02]
   - ['firstinputdelay_seconds_bucket', {'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55', 'le': '0.005'}, 0]
   - ['firstinputdelay_seconds_bucket', {'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55', 'le': '0.01'}, 0]
   - ['firstinputdelay_seconds_bucket', {'group': 'group1', 'ua_family': 'Firefox', 'ua_version': '55', 'le': '0.025'}, 1]

EventGate:
 input:
  - {"event": {"pageviewToken":"example", "name":"first-paint", "startTime":805, "isOversample":true, "isAnon":false, "oversampleReason": "[\"wiki:cawiki\"]", "originCountry":"FR" }, "schema": "PaintTiming", "webHost": "ca.wikipedia.org", "wiki": "cawiki", "$schema": "/analytics/legacy/painttiming/1.1.0", "meta": {"dt": "2020-04-02T19:11:20.942Z", "stream": "eventlogging_PaintTiming", "id": "b0caf18d-6c7f-4403-947d-2712bbe28610", "request_id": "bd54dd80-7515-11ea-98e5-fd72443e8b45"}, "dt": "2020-04-02T19:11:20.942Z", "http": {"request_headers": {"user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36"}}}
 expect:
  - frontend.navtiming2_oversample.firstPaint.desktop.authenticated:805|ms
  - frontend.navtiming2_oversample.firstPaint.desktop.overall:805|ms
  - frontend.navtiming2_oversample.firstPaint.overall:805|ms
  - frontend.navtiming2_oversample.firstPaint.by_browser.Chrome.80:805|ms
  - frontend.navtiming2_oversample.firstPaint.by_browser.Chrome.all:805|ms
  - frontend.navtiming2_oversample.firstPaint.by_continent.Europe:805|ms
  - frontend.navtiming2_oversample.firstPaint.by_country.France:805|ms
  - frontend.painttiming_group.group1:1|c
